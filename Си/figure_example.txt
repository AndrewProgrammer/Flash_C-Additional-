#include <iostream>
#include <Windows.h>
#include <conio.h>
using namespace std;

void main()
{
	HANDLE h = GetStdHandle(STD_OUTPUT_HANDLE);//создаем объект, содержащий информацию о потоке вывода (хендл)
	CONSOLE_CURSOR_INFO cci = { sizeof(cci), false };//создаем объект, содержащий настройки для хендла с указанием не отображать курсор
	SetConsoleCursorInfo(h, &cci);

	COORD c = { 5, 5 };
	bool flag = true;
	int color_text = 0, color_fon=0;
	int dx = 0, dy = 0;
	do
	{
		COORD t = c;
		for (int y = 0; y < 7; y++)
		{
			SetConsoleCursorPosition(h, t);
			for (int x = 0; x < 7;x++)
			if (x == 0 || y == 0 || x == 6 || y == 6)
				cout << '*';
			else
				cout << ' ';
			t.Y++;
		}
		int k = _getch();//считываем код нажатой клавиши
		if (k == 0 || k == 224)//если была нажата управляющая клавиша
			k = _getch();//то считываем второй код из буфера
		switch (k)//отправляем результат для управления оператором выбора
		{
		case 'S':
		case 's':
		case 80://если была нажата клавиша вниз
			dy = 1;//то приращение по оси ординат будет положительным
			dx = 0;//по оси абсцисс приращение нулевое
			break;
		case 'W':
		case 'w':
		case 72://если вверх
			dy = -1;//аналогично согласно геометрической логике
			dx = 0;
			break;
		case 'A':
		case 'a':
		case 75://есди влево
			dy = 0;
			dx = -1;
			break;
		case 'D':
		case 'd':
		case 77://если вправо
			dy = 0;
			dx = 1;
			break;
		case 27://если была нажата клавиша ESC
			flag = false;//устанавливаем флажок на ЛОЖЬ
			//break пропускаем специально, чтоб сработал default
		default:
			dx = dy = 0;//если была нажата любая иная клавиша, то приращения равны нулю
		}
		system("cls");
		c.X += dx;//приращаем абсциссу
		c.Y += dy;//приращаем ординату
		if (c.X<0)//проверяем на выход за левую границу консоли
			c.X = 0;//и устанавливаем минимально допустимое значение абсциссы
		else if (c.X>70)
			c.X = 70;
		if (c.Y<0)//то же самое для ординаты
			c.Y = 0;
		else if (c.Y>20)
			c.Y = 20;
		
	} while (flag);//цикл продолжается, пока флажок равен значению ИСТИНА
}

